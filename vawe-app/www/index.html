<!DOCTYPE html>
<html>
<style type="text/css">
	body {
		margin: 0;
		padding: 0;
	}
	.ui-icon-csm-home:after {
		background-image: url(img/Home%20Green.png);
	}
	.ui-btn-active {
		background-color: #6EB02D!important;
	}
	.ui-nodisc-icon.ui-btn:after, .ui-nodisc-icon .ui-btn:after {
		background-color: #ED248F!important;
	}
	.ui-input-search {
		margin-left:10px!important;
		margin-right:10px!important;
	}
	.facebook {
		background-image:url(img/facebook-login-blue.png);
	}
	.google {
		background-image:url(img/google-sign-in.png);
	}
</style>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link rel="stylesheet" href="css/jquery.mobile-1.4.5.css" />
<script src="http://code.jquery.com/jquery-1.11.1.js"></script>
<script src="http://code.jquery.com/mobile/1.4.5/jquery.mobile-1.4.5.js"></script>
<script type="text/javascript" src="cordova.js"></script>
<script type="text/javascript">

    var map;
	var login = "false";
    document.addEventListener("deviceready", function() {
		
      var div = document.getElementById("map_canvas");

      // Initialize the map view
      map = plugin.google.maps.Map.getMap(div);

      // Wait until the map is ready status.
      map.addEventListener(plugin.google.maps.event.MAP_READY, onMapReady);
		  
	  map.getMyLocation(function(location) {
	  var msg = ["Current your location:\n",
		"latitude:" + location.latLng.lat,
		"longitude:" + location.latLng.lng,
		"speed:" + location.speed,
		"time:" + location.time,
		"bearing:" + location.bearing].join("\n");
	
	  map.addMarker({
		'position': location.latLng,
		'title': msg
	  }, function(marker) {
		marker.showInfoWindow();
	  });
	});
    }, false);

    function onMapReady() {
      var button = document.getElementById("button");
      button.addEventListener("click", onBtnClicked, false);
    }

    function onBtnClicked() {
      map.showDialog();
    }
	$(document).on( "pageinit", "#vendors", function() {
		var filter = 0;
		 $.ajax({
			type: "POST",
			url: "vendorlist.php",
			data: 'filter=' + filter,
			cache: false,
			success: function(data) 
			{
				document.getElementById("results").innerHTML = data;
				$("#results").listview("refresh");
			}
		 });
	});
	function changePage(vendorID) {
		$( ":mobile-pagecontainer" ).pagecontainer( "change", "#vendor-page", { transition: "slide" });
		$.ajax({
			type: "POST",
			url: "vendorpull.php",
			data: 'id=' + vendorID,
			cache: false,
			success: function(data) 
			{
				document.getElementById("vendor-data").innerHTML = data;
				var e = document.getElementById("vendor-message");
				e.setAttribute("name", vendorID);
			}
		 });
	}
    </script>
</head>
<body>
<div id="page1" data-role="page">
	<div data-role="header" data-position="fixed" align="center"><img src="img/VAWE-long-300x30-transparent.png" width="300" height="30" alt=""/></div>
	<div data-role="content" style="margin:0; padding:0;">
		Main Content
	</div>
	<div data-role="footer" data-position="fixed">
		<div data-role="navbar" class="ui-nodisc-icon">
			<ul>
				<li><a href="#" class="ui-icon-home ui-btn-icon-top ui-btn-active">Home</a></li>
				<li><a href="#" class="ui-icon-calendar ui-btn-icon-top">Events</a></li>
				<li><a href="#vendors" class="ui-icon-search ui-btn-icon-top">Vendors</a></li>
				<li><a href="#map" class="ui-icon-location ui-btn-icon-top">Map</a></li>
				<li><a href="#" onClick="loginCheck()" class="ui-icon-user ui-btn-icon-top">My Profile</a></li>
			</ul>
		</div>
	</div>
</div>
<div id="vendors" data-role="page" data-transition="slideup">
	<div data-role="header" data-position="fixed" align="center"><img src="img/VAWE-long-300x30-transparent.png" width="300" height="30" alt=""/></div>
	<div data-role="content" style="margin:0px; padding:0px;">
		<ul id="results" class="ui-btn" data-filter="true" data-filter-placeholder="Search vendors..." data-role="listview" style="padding-left:10px; padding-right:10px;">
		</ul>
	</div>
	<div data-role="footer" data-position="fixed">
		<div data-role="navbar" class="ui-nodisc-icon">
			<ul>
				<li><a href="#page1" class="ui-icon-home ui-btn-icon-top">Home</a></li>
				<li><a href="#" class="ui-icon-calendar ui-btn-icon-top">Events</a></li>
				<li><a href="#" class="ui-icon-search ui-btn-icon-top">Vendors</a></li>
				<li><a href="#map" class="ui-icon-location ui-btn-icon-top">Map</a></li>
				<li><a href="#" onClick="loginCheck()" class="ui-icon-user ui-btn-icon-top">My Profile</a></li>
			</ul>
		</div>
	</div>
</div>
<div id="map" data-role="page" data-transition="slideup">
	<div data-role="header" data-position="fixed" align="center"><img src="img/VAWE-long-300x30-transparent.png" width="300" height="30" alt=""/></div>
	<div data-role="content" style="margin:0px; padding:0px;">
		<div style="width:100%;height:400px; min-height:90%;" id="map_canvas"></div>
		<button id="button">Navigate</button>
	</div>
	<div data-role="footer" data-position="fixed">
		<div data-role="navbar" class="ui-nodisc-icon">
			<ul>
				<li><a href="#page1" class="ui-icon-home ui-btn-icon-top">Home</a></li>
				<li><a href="#" class="ui-icon-calendar ui-btn-icon-top">Events</a></li>
				<li><a href="#vendors" class="ui-icon-search ui-btn-icon-top">Vendors</a></li>
				<li><a href="#" class="ui-icon-location ui-btn-icon-top">Map</a></li>
				<li><a href="#" onClick="loginCheck()" class="ui-icon-user ui-btn-icon-top">My Profile</a></li>
			</ul>
		</div>
	</div>
</div>
<div id="vendor-page" data-role="page" data-transition="flip">
	<div data-role="header" data-position="fixed" align="center"><img src="img/VAWE-long-300x30-transparent.png" width="300" height="30" alt=""/></div>
	<a href="#" data-rel="back" data-icon="back" data-iconpos="left" style="margin-left:10px; margin-right:10px;" class="ui-btn ui-btn-b ui-icon-back ui-btn-icon-left ui-shadow-icon ui-corner-all">Back</a>
	<div id="vendor-data" data-role="content">
	</div>
	<a href="#message-vendor" id="vendor-message" data-rel="dialog" style="margin-left:10px; margin-right:10px;" class="ui-btn ui-btn-a ui-icon-mail ui-corner-all ui-btn-icon-left" data-transition="flip">Message Vendor</a>
	<div data-role="footer" data-position="fixed">
		<div data-role="navbar" class="ui-nodisc-icon">
			<ul>
				<li><a href="#page1" class="ui-icon-home ui-btn-icon-top">Home</a></li>
				<li><a href="#" class="ui-icon-calendar ui-btn-icon-top">Events</a></li>
				<li><a href="#vendors" class="ui-icon-search ui-btn-icon-top">Vendors</a></li>
				<li><a href="#map" class="ui-icon-location ui-btn-icon-top">Map</a></li>
				<li><a href="#" onClick="loginCheck()" class="ui-icon-user ui-btn-icon-top">My Profile</a></li>
			</ul>
		</div>
	</div>
</div>
<div id="message-vendor" data-role="dialog" class="ui-overlay-shadow" data-transition="flip">
	<div data-role="header" class="ui-header ui-bar-b">
		<a href="#" data-rel="back" class="ui-btn ui-btn-b ui-icon-shadow ui-corner-all ui-btn-left ui-icon-left ui-btn-icon-notext ui-icon-back">Close</a>
		<h3>Send a Message</h3>
	</div>
	<div data-role="main" class="ui-content">
		Test Content
		<a href="#" class="ui-btn ui-btn-a ui-icon-arrow-r ui-icon-right">Send Message</a>
		<a href="#" data-rel="back" class="ui-btn ui-btn-b ui-icon-shadow ui-icon-right ui-icon-delete">Cancel</a>
	</div>
</div>
<div id="login-page" data-role="dialog" class="ui-overlay-shadow" data-transition="flip">
	<div data-role="header" class="ui-header ui-bar-b">
		<h3>Login</h3>
	</div>
	<div data-role="main" class="ui-content">
		<form id="login-form">
			<input type="text" id="user" name="user" placeholder="Username"/>
			<input type="password" id="pass" name="pass" placeholder="Password"/>
			<input type="button" id="login-submit" value="Login"/>
			<h6><a href="reset.html">Forgot password? Click here to reset.</a></h6>
		</form>
		<br/>
		<a href="#" class="ui-btn ui-btn-b">Join VAWE</a>
	</div>
</div>
<div data-role="panel" id="profile" data-position="right" data-display="overlay" data-theme="b" class="ui-panel ui-panel-position-right ui-panel-display-overlay ui-body-b ui-panel-animate ui-panel-closed">
	<div class="ui-panel-inner"><h3>My Profile</h3><p>Test Content</p><a href="#demo-links" data-rel="close" class="ui-btn ui-shadow ui-corner-all ui-btn-a ui-icon-delete ui-btn-icon-left ui-btn-inline">Close panel</a></div>
	</div>
</body>
	<script type="text/javascript">
		function loginCheck() {
			$.ajax({
				url: "login.php",
				cache: false,
				success: function(data)
				{
					if (login == "false") {
						$( ":mobile-pagecontainer" ).pagecontainer( "change", "#login-page", { transition: "slide" });
					}
					else {
						$("#profile").panel();
						$("#profile").panel("open").enhanceWithin();
					}
				}
			});
		}
		$("#login-submit").click(function(){
			$("#login-form").trigger("submit");
		});
		$("#login-form").submit(function(e){
			e.preventDefault();
			$.ajax({
				type: "POST",
				url: "logincheck.php",
				data: $("#login-form").serialize(),
				cache: false,
				success: function(data)
				{
					if (data == "1") {
						window.login = "true";
						$( ":mobile-pagecontainer" ).pagecontainer( "change", "#page1", { transition: "flip" });
					}
					else {
						alert("Username or password Incorrect. Please try again.");
					}
				}
			});
		});
	</script>
</html>